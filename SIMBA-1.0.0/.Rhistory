dfij$ku<-ku
dfij$d<-d
dfij
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-min(v)+1
msup<-function(v)min((m-floor(min(v)/2)),n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-min(v)+1
msup<-function(v)min((m-floor(min(v)/2)),n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
n=7
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-min(v)+1
msup<-function(v)min((m-floor(min(v)/2)),n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
dfij
v<-dfij
v<-dfij[1]
vd<-v[5]
v<-dfij[1,]
vd<-v[5]  ## v[5] serà d
k<-numeric(vd+1)
vd
v
v<-as.numeric(dfij[1,])
vd<-v[5]
k<-numeric(vd+1)
(vd==0)
if (vd==0) k<-v[3]
k
n=3
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-min(v)+1
msup<-function(v)min((m-floor(min(v)/2)),n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
n=5
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-min(v)+1
msup<-function(v)min((m-floor(min(v)/2)),n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
n=7
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)min((m-floor(min(v)/2)),n-sum(v))
msup<-m
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)min((m-floor(min(v)/2)),n-sum(v))
msup<-m
minf<-function(v)min((m-floor(min(v)/2)),n-sum(v))
msup<-function(v)min(m,n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
n=3
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)min((m-floor(min(v)/2)),n-sum(v))
msup<-function(v)min(m,n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
d
dfij
n=3
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-floor(min(v)/2)
msup<-function(v)min(m,n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
dfij
n=3
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-floor(min(v)/2)+1
msup<-function(v)min(m,n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
dfij
dfij<-subset(dfij,d>=0)
dfij
n=5
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-floor(min(v)/2)+1
msup<-function(v)min(m,n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
n=7
m<-floor(n/2)
i<-rep(0:n,(n+1):1)
j<-0:n
for (u in (n-1):0) j<-c(j,0:u)
dfij<-data.frame(i,j)
minf<-function(v)m-floor(min(v)/2)+1
msup<-function(v)min(m,n-sum(v))
kl<-apply(dfij,1,"minf")
ku<-apply(dfij,1,"msup")
d<-ku-kl
dfij$kl<-kl
dfij$ku<-ku
dfij$d<-d
# eliminem les files on d<0 perquè no dónen cap valor possible de k
dfij<-subset(dfij,d>=0)
dfij
4.4*10^(-5)
round(4.4*10^(-5), digits=6)
round(4.4*10^(-5), digits=8)
library(xtable); library(fBasics); library(FactoMineR)
data<-decathlon
data(decathlon, package="FactoMineR")
data<-decathlon
xnor<-runif(10000,0,1)
m<-mean(xnor)
xnor<-runif(10000,0,1)
mi<-round(mean(xnor),5)
temps<- deca[c(1,5,6,10)]
maxt<-apply(temps,2,max)
transf<-  sweep(temps,2,maxt,FUN="-")
transf<- -transf
deca[c(1,5,6,10)]<-transf
library(xtable); library(fBasics); library(FactoMineR)
data(decathlon, package="FactoMineR")   ## carrega el fitxer (de R) a l'espai de treball
deca<-decathlon
temps<- deca[c(1,5,6,10)]
maxt<-apply(temps,2,max)
transf<-  sweep(temps,2,maxt,FUN="-")
transf<- -transf
deca[c(1,5,6,10)]<-transf
basic<-deca[-(39:41),-(11:13)]             # dades bàsiques
i.sup<- deca[39:41,-(11:13)]               # individus suplementaris
n.sup<- deca[-(39:41),11:12]               # v. numèriques suplementàries
q.sup<- as.factor(deca[-(39:41),13])
View(basic)
View(basic)
mida<-10000
xu<-runif(mida,0,1)
mi<-round(mean(xu),5)
##
y< 1.34-2.72*xu+rnorm(mida,0,0.02)
##
y<- 1.34-2.72*xu+rnorm(mida,0,0.02)
mida<-10000
xu<-runif(mida,0,1)
mi<-round(mean(xu),5)
##
y<- 1.34-2.72*xu+rnorm(mida,0,0.02)
mod<-lm(y~xu)
setwd("D:/MLmat/pracs/prac2")
mod$
dades<-read.table("dwaine.txt",header=T)
head(dades); dim(dades)
install.packages("lawstat")
install.packages("nortest")
library(car);library(lmtest);library(lawstat);library(nortest);library(doBy);library(foreign);library(MASS)
setwd("C:/Users/farre/Desktop/IERMB_MerceNov17")
require(cowplot)
library(mnormt)
library(stringr)
library(tidyr)
library(semPlot)
library(lavaan)
library(psych)
library(car)
library(smoothmest)
library(VGAM)
library(rgdal)
library(RColorBrewer)
library(classInt)
library(fields)
library(sp)
library(GISTools)
library(maptools)
library(SmarterPoland)
library(reshape2)
library(factoextra)
require(xtable)
require(mice)
require(doBy)
data=read.csv2('datax.csv')
data=data[,-1]
rownames(data)=paste(data[,1],data[,2],data[,4],sep=" ")
print(xtable(head(data,4),caption="Header of the original data file: \texttt{data}.",digits=1  ),size="\\tiny")
cdata<-na.omit(data)       # complete data
print(xtable(head(cdata,4),caption="Header of the complete data file: \texttt{cdata}.",digits=1),size="\\tiny")
dat=data #head(dat)
d.na.p=dat[!is.na(dat$GDPpc),]
d.na.p=d.na.p[!is.na(d.na.p$GREpc),]
d.na.p=d.na.p[!is.na(d.na.p$URDpsk),]
d.na.p=d.na.p[is.na(d.na.p$PATth),]
d.na.p=d.na.p[sample(nrow(d.na.p),1035),]
d.na.g=dat[!is.na(dat$PATth),]
d.na.g=unique(rbind(d.na.g[is.na(d.na.g$GDPpc),],d.na.g[is.na(d.na.g$GREpc),]))
gty=unique(rbind(d.na.g,d.na.p))
dt=unique(rbind(na.omit(dat),gty))
imp.dt=mice(dt[5:10],m=10,maxit=10,method = 'norm',  printFlag = FALSE)
dr=mice::complete(imp.dt)
dt=data.frame(dt[,1:4],dr)    ## imputed data   ## ---- "dt" is the imputed data set
dt=subset(dt,GDPpc>0)
dt=subset(dt,PATth>0)
dt=subset(dt,URDpsk>0)
dt=subset(dt,URGpor<100.1)
print(xtable(head(dt,4),caption="Header of the complete-imputed  data file: \texttt{dt}.",digits=1),size="\\tiny")
MGA=as.matrix.data.frame(unique(data[4]))
MGA=data.frame(MGA,
c('No Megaregion','Vienna Budapest','Frakfurt Gart','Ambsterdan Bruselas Twerp','Prague','Berlin','Lisbon','Madrid','Barcelona Lyon','Paris','Roma Milan Turin','London','Glasgow Edinburgh'))
colnames(MGA)=c('Abbreviation','Name')
rownames(MGA)=NULL
MGA=sapply(MGA,as.character)
#Mega regions all years aggregated
############ population
pop=read.csv2('pop.csv')
pop=pop[,-c(1,3,4)]    # traiem X (numeració), i els anys 2012 i 2011
colnames(pop)[2:17]=paste(2010:1995)
## head(pop)
pop_long=gather(pop,year,pop,2:17,factor_key = FALSE)
pop_long=data.frame(paste(pop_long[,1],as.numeric(as.character(pop_long[,2]))),pop_long[,3])
colnames(pop_long)=c('ID','pop')
dM=data.frame(paste(data[,1],data[,2]),data)
colnames(dM)[1]='ID'
dM=merge(dM,pop_long,by.x=1,by.y = 1,all.x  = TRUE)
#head(dM); dim(dM)
ilu<-read.csv2('ilumi.csv')
head(ilu)
names(ilu)<-c("Year","NUTS3",names(ilu)[3:5])
ilu=data.frame(paste(ilu[,2],as.numeric(as.character(ilu[,1]))),ilu[,3:5])
names(ilu)<-c("ID",names(ilu)[2:4])
setwd("D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0")
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
source(paste0(script.dirname,"/init.R")) # Script per obrir tots els paquets necesaris
source(paste0(script.dirname,"/ui.R")) # User Interface
source(paste0(script.dirname,"/init.R"))
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/"
source(paste0(script.dirname,"/init.R")) # Script per obrir tots els paquets necesaris
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
source(paste0(script.dirname,"/init.R"))
source(paste0(script.dirname,"/ui.R"))
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/"
source(paste0(script.dirname,"/init.R")) # Script per obrir tots els paquets necesaris
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0"
source(paste0(script.dirname,"/init.R"))
install.packages(c("plotly", "codetoools", "writexl"))
install.packages(c("openxlsx", "FactoMineR", "knitr"))
install.packages(c(""zoo"", ""colourpicker"", ""RColorBrewer"", ""shinycssloaders"", ""shinyjs"", ""ggplot2"", ""heatmaply"", ""gplots"", ""Biobase"", ""RCurl"", ""genefilter"", ""shinythemes"", ""DT"", ""tools"", ""readxl"", ""shiny"", ""shinymaterial"", ""stringi""))
install.packages(c("zoo", "colourpicker"))
install.packages(c("c("RColorBrewer"", ""shinycssloaders"", ""shinyjs"", ""ggplot2"", ""heatmaply"", ""gplots"", ""Biobase"", ""RCurl"", ""genefilter"", ""shinythemes"", ""DT"", ""tools"", ""readxl"", ""shiny"", ""shinymaterial"", ""stringi")"))
install.packages(c("RColorBrewer", "shinycssloaders", "shinyjs"))
install.packages(c("ggplot2","heatmaply","gplots","Biobase","RCurl",
"genefilter","shinythemes","DT","tools","readxl","shiny",
"shinymaterial","stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
install.packages(c("ggplot2", "heatmaply", "gplots", "Biobase", "RCurl", "genefilter", "shinythemes", "DT", "tools", "readxl", "shiny", "shinymaterial", "stringi"))
library("plotly", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("codetools", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("writexl", lib.loc="C:/Program Files/R/R-3.4.3/library")
install.packages("openxlsx")
library("openxlsx", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("FactoMineR", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("knitr", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("zoo", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("colourpicker", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("RColorBrewer", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("shiny", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("shinycssloaders", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("shinythemes", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("shinymaterial", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("shinyjs", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("ggplot2", lib.loc="C:/Program Files/R/R-3.4.3/library")
install.packages("gplots")
library("gplots", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("heatmaply", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("Biobase", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("RCurl", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("genefilter", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("DT", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("tools", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("readxl", lib.loc="C:/Program Files/R/R-3.4.3/library")
library("stringi", lib.loc="C:/Program Files/R/R-3.4.3/library")
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0"
source(paste0(script.dirname,"/ui.R"))
install.packages("shiny")
source(paste0(script.dirname,"/ui.R"))
sidebarPanel
help(sidebarPanel)
??sidebarPanel
require(shiny)
help(sidebarPanel)
source(paste0(script.dirname,"/ui.R"))
??withSpinner
require(shinycssloaders)
source(paste0(script.dirname,"/ui.R"))
??plotlyOutput
source(paste0(script.dirname,"/init.R"))
source(paste0(script.dirname,"/ui.R"))
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
source(paste0(script.dirname,"/init.R")) # Script per obrir tots els paquets necesaris
source(paste0(script.dirname,"/ui.R")) # User Interface
source(paste0(script.dirname,"/server.R")) #Server
options(warn=-1)
shinyApp(ui = ui, server = server, options = c(launch.browser=T))
shinyApp(ui = ui, server = server, options = c(launch.browser=T))
shinyApp(ui = ui, server = server, options = c(launch.browser=T))
citation(package = "mice", lib.loc = NULL, auto = NULL)
citation(package = "lavaan", lib.loc = NULL, auto = NULL)
citation(package = "car", lib.loc = NULL, auto = NULL)
citation(package = "psych", lib.loc = NULL, auto = NULL)
citation(package = "VGAM", lib.loc = NULL, auto = NULL)
citation(package = "FactoMineR", lib.loc = NULL, auto = NULL)
citation(package = "factoextra", lib.loc = NULL, auto = NULL)
citation(package = "GISTools", lib.loc = NULL, auto = NULL)
citation(package = "maptools", lib.loc = NULL, auto = NULL)
citation(package = "smoothmest", lib.loc = NULL, auto = NULL)
citation(package = "semPlot", lib.loc = NULL, auto = NULL)
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
source(paste0(script.dirname,"/init.R")) # Script per obrir tots els paquets necesaris
source(paste0(script.dirname,"/ui.R"))
paste0(script.dirname,"/init.R")
source(paste0(script.dirname,"./init.R"))
source(paste0(script.dirname,"./ui.R"))
source(paste0(script.dirname,"./server.R"))
options(warn=-1)
shinyApp(ui = ui, server = server, options = c(launch.browser=T))
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0"
source(paste0(script.dirname,"./init.R"))
source(paste0(script.dirname,"./ui.R"))
source(paste0(script.dirname,"./server.R"))
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
source(paste0(script.dirname,"./init.R"))
source(paste0(script.dirname,"./ui.R"))
source(paste0(script.dirname,"./server.R"))
options(warn=-1)
shinyApp(ui = ui, server = server, options = c(launch.browser=T))
script.dirname <- "D:/TFGiTFM/TFGiM1718/tfgARodriguez/10O18_simba/simba/SIMBA-1.0.0/"
source(paste0(script.dirname,"init.R"))
source(paste0(script.dirname,"ui.R"))
source(paste0(script.dirname,"server.R"))
options(warn=-1)
shinyApp(ui = ui, server = server, options = c(launch.browser=T))
.21*.2*.9 + .25*.8*.1
readRDS('mitjanes.RDS')
colors <- readRDS('colors.RDS')
library(FactoMineR)
pcajetr<-PCA(mitjanes,quali.sup=1,graph=F)
par(mfrow = c(1,2),
oma = c(0,0,0,0) + 0.5,
mar = c(4,4,4,4) + 0.5)
mitjanes <- readRDS('mitjanes.RDS')
colors <- readRDS('colors.RDS')
pcajetr<-PCA(mitjanes,quali.sup=1,graph=F)
par(mfrow = c(1,2),
oma = c(0,0,0,0) + 0.5,
mar = c(4,4,4,4) + 0.5)
plot(pcajetr,choix="var",col.var="blue",cex.main=0.7)
plot(pcajetr,choix="ind",habillage=1,label="quali",cex.main=0.7)
plot.PCA(pcajetr,choix="ind",col.ind=colors$colors, invisible="quali",label="none")
legend("topright",colors$gene_functions, cex=0.6, col=cols,lty=1,bg="white")
plot.PCA(pcajetr,choix="ind",col.ind=colors$colors, invisible="quali",label="none")
colorize_functions <- readRDS('color_funs.RDS')
colorize_functions
plot.PCA(pcajetr,choix="ind",col.ind=colorize_functions, invisible="quali",label="none")
par(mfrow = c(1,1))
plot.PCA(pcajetr,choix="ind",col.ind=colorize_functions, invisible="quali",label="none")
colors
legend("topright",colors$gene_functions, cex=0.6, col=colors$colors,lty=1,bg="white")
pcaux <- readRDS('pca.RDS')
colors <- readRDS('colors.RDS')
colorize_functions <- readRDS('color_funs.RDS')
gris <- 4
colorbase<-gray.colors(1,0.3+gris*0.05,0.3+gris*0.1)
plot(pcaux, axes=eixos, choix="var", col.var=colorbase,
lwd=gruix, cex.main=cextit, cex=cexlletra*.8,  cex.lab=cexlab,cex.axis=cexax)
gris <- 4
colorbase<-gray.colors(1,0.3+gris*0.05,0.3+gris*0.1)
eixos=c(1,2)
gruix=1.7
gris=4
limcos2=0.5
cextit=.7
cexleg=.6
cexlab=.6
cexax=.6
cexlletra=.7
plot(pcaux, axes=eixos, choix="var", col.var=colorbase,
lwd=gruix, cex.main=cextit, cex=cexlletra*.8,  cex.lab=cexlab,cex.axis=cexax)
plot(pcaux, axes=eixos, choix="var", col.var=colorize_functions,
lwd=gruix, cex.main=cextit, cex=cexlletra*.8,  cex.lab=cexlab,cex.axis=cexax)
# pcajetr<-PCA(mitjanes,quali.sup=1,graph=F)
# par(mfrow = c(1,1))
# plot(pcajetr,choix="var",col.var="blue",cex.main=0.7)
# plot(pcajetr,choix="ind",habillage=1,label="quali",cex.main=0.7)
#
# plot.PCA(pcajetr,choix="ind",col.ind=colorize_functions, invisible="quali",label="none")
legend("topright",colors$gene_functions, cex=0.6, col=colors$colors,lty=1,bg="white")
